0100     .OPT NO LIST
0110 ; LINE DRAW, VER 3.1
0120 XPOS =  $55
0130 YPOS =  $54
0140 YNEW =  $0610
0150 XNEW =  $0611
0160 ROWAC = $72
0170 COLAC = $73
0180 ROWACH = $20
0190 COLACH = $21
0200 COUNTR = $74
0210 ENDPT = $75
0220 DELTAROW = $76
0230 DELTACOL = $77
0240 ROWINC = $7E
0250 COLINC = $7F
0260 PLOTPOINT = $A400
0270     *=  $A700
0280     CLD 
0290     LDX #0
0300     STX COLINC
0310     STX COLAC
0320     STX COLACH
0330     STX ROWINC
0340     STX ROWAC
0350     STX ROWACH
0360     LDA XNEW
0370     CMP XPOS
0380     BCC NEWXSMALLER
0390     BEQ XEQUAL
0400     INC COLINC
0410 XEQUAL
0420     SEC 
0430     SBC XPOS
0440     CLC 
0450     BCC STOREDELTAC
0460 NEWXSMALLER
0470     DEC COLINC
0480     LDA XPOS
0490     SEC 
0500     SBC XNEW
0510 STOREDELTAC
0520     STA DELTACOL
0530     LDA YNEW
0540     CMP YPOS
0550     BCC NEWYSMALLER
0560     BEQ YEQUAL
0570     INC ROWINC
0580 YEQUAL
0590     SEC 
0600     SBC YPOS
0610     CLC 
0620     BCC STOREDELTAR
0630 NEWYSMALLER
0640     DEC ROWINC
0650     LDA YPOS
0660     SEC 
0670     SBC YNEW
0680 STOREDELTAR
0690     STA DELTAROW
0700     CMP DELTACOL
0710     BCS ROWBIGGER
0720     LDA DELTACOL
0730     STA ENDPT
0740     LSR A
0750     STA ROWAC
0760     BPL SETCOUNT
0770 ROWBIGGER
0780     STA ENDPT
0790     LSR A
0800     STA COLAC
0810 SETCOUNT
0820     LDA ENDPT
0830     STA COUNTR
0840     JSR PLOTPOINT
0850     LDA COUNTR
0860     BNE DO
0870     RTS 
0880 DO
0890     LDA COLAC
0900     CLC 
0910     ADC DELTACOL
0920     STA COLAC
0930     BCC NOINC1
0940     INC COLACH
0950 NOINC1
0960     LDY COLACH
0970     BNE SUB1
0980     CMP ENDPT
0990     BCC DOROW
1000 SUB1
1010     SEC 
1020     SBC ENDPT
1030     STA COLAC
1040     BCS NODEC1
1050     DEC COLACH
1060 NODEC1
1070     LDA XPOS
1080     CLC 
1090     ADC COLINC
1100     STA XPOS
1110 DOROW
1120     LDA ROWAC
1130     CLC 
1140     ADC DELTAROW
1150     STA ROWAC
1160     BCC NOINC2
1170     INC ROWACH
1180 NOINC2
1190     LDY ROWACH
1200     BNE SUB2
1210     CMP ENDPT
1220     BCC DOPLOT
1230 SUB2
1240     SEC 
1250     SBC ENDPT
1260     STA ROWAC
1270     BCS NODEC2
1280     DEC ROWACH
1290 NODEC2
1300     LDA YPOS
1310     CLC 
1320     ADC ROWINC
1330     STA YPOS
1340 DOPLOT
1350     JSR PLOTPOINT
1360     DEC COUNTR
1370     BNE DO
1380     RTS 
