ca65 V2.18 - Ubuntu 2.19-1
Main file   : scroll.asm
Current file: scroll.asm

000000r 1               ;Program 4: VBI Routine
000000r 1               ;Source Code
000000r 1               ; original: http://archive.org/stream/1985-12-compute-magazine/Compute_Issue_067_1985_Dec#page/n0/mode/2up
000000r 1               
000000r 1               ; VBI rautine
000000r 1               ; for combined fine and
000000r 1               ; coarse scrolling
000000r 1               ; in graphics mode 0.
000000r 1               ;
000000r 1               ; Change the 1 in line
000000r 1               ; 25 to scroll slower,
000000r 1               ; Change the 7 in line
000000r 1               ; 33 to the number of scan lines
000000r 1               ;per mode line minus 1 far other graphics modes
000000r 1               ;Change the 40 in line 39 to the number of jbytes per mode line f
000000r 1               ;or other graphics modes
000000r 1               
000000r 1                   .org $0600   ;Load into page 6.
000600  1  68               PLA         ;Remove argument count.
000601  1  A0 0A            LDY #10     ;These 4 statements set up
000603  1  A2 06            LDX #6      ;a deferred vertical blank
000605  1  A9 07            LDA #7      ;interrupt - use LDA #6 -for
000607  1  4C 5C E4         JMP $E45C   ;an immediate VBI.
00060A  1  E6 CB            INC $CB     ;$CB is counter for number of
00060C  1  A9 01            LDA #1      ;VB cycles before next scroll.
00060E  1  C5 CB            CMP $CB     ;If not up to desired interval
000610  1  D0 2A            BNE EXIT    ;then exit VBI
000612  1  E6 CC            INC $CC     ;$CC is counter for number
000614  1  A5 CC            LDA $CC     ;of fine scrolls.
000616  1  8D 05 D4         STA $D405   ;Storein vertical fine scroil register.
000619  1  A9 00            LDA #0      ;reset VB counter
00061B  1  85 CB            STA $CB
00061D  1  A9 07            LDA #7      ;Have We done y fine
00061F  1  C5 CC            CMP $CC     ;scrolls yet?
000621  1  B0 19            BCS EXIT    ;No, exit VBI.
000623  1  A9 00            LDA #0      ; Yes,
000625  1  8D 05 D4         STA $D405   ;reset vertical scroll register,
000628  1  85 CC            STA $CC     ;reset scroll counter,
00062A  1  A9 28            LDA #40     ; and Coarse scroll by
00062C  1  A0 04            LDY #4      ;adding 40 to low byte
00062E  1  18               CLC         ;of screen memory pointer.
00062F  1  71 CD            ADC ($CD),Y
000631  1  91 CD            STA ($CD) ,Y
000633  1  90 07            BCC EXIT ; If carry not set then exit VBI ,
000635  1  C8               INY ;else increment high byte
000636  1  A9 00            LDA #0 ;of screen memory pointer.
000638  1  71 CD            ADC ($CD),Y
00063A  1  91 CD            STA ($CD),Y
00063C  1  4C 62 E4     EXIT: JMP $E462
00063C  1               
